.\" $Id: spamass-milter.1.in,v 1.9 2003/06/03 06:24:54 dnelson Exp $
.Dd July 25, 2001
.Os
.Dt SPAMASS_MILTER 8
.Sh NAME
.Nm spamass-milter
.Nd sendmail milter for passing emails through SpamAssassin
.Sh SYNOPSIS
.Nm
.Fl p Pa socket
.Op Fl d Ar nn
.Op Fl D Ar host
.Op Fl f
.Op Fl i Ar networks
.Op Fl m
.Op Fl r Ar nn
.Op Fl u Ar defaultuser
.Op Fl - Ar spamc flags ...
.Sh DESCRIPTION
The
.Nm
utility is a sendmail milter that checks and modifies incoming email
messages with SpamAssassin.
.Pp
The following options are available:
.Bl -tag -width "indent"
.It Fl p Pa socket
Specifies the pathname of a socket to create for communication with
.Nm sendmail .
If it is removed,
.Nm sendmail
will not be able to access the milter.  This may cause
messages to bounce, queue, or be passed through unmiltered, depending
on the parameters in
.Nm sendmail Ns 's .cf file.
.It Fl d Ar nn
Sets the debug level:
.Bl -tag -width "indent"
.It 1
Log entry and exit of internal functions.
.It 2
Also log I/O operations with 
.Nm spamc .
.It 3
Also log the results of string comparisons.
.El
.It Fl D Ar host
Connects to a remost spamd server on 
.Ar host , 
instead of using one on localhost.
This option is deprecated; use 
.Fl - Fl d Ar host 
instead.
.It Fl f
Causes
.Nm
to fork into the background.
.It Fl i Ar networks
Ignores messages if the originating IP is in the network(s) listed. 
The message will be passed through without calling SpamAssassin at all.
.Ar networks
is a comma-separated list, where each element can be either an IP address 
(nnn.nnn.nnn.nnn), a CIDR network (nnn.nnn.nnn.nnn/nn), or a network/netmask
pair (nnn.nnn.nnn.nnn/nnn.nnn.nnn.nnn).  Multiple
.Fl i
flags will append to the list.
.It Fl m
Disables modification of the Subject: and Content-Type: headers and
message body. This is useful when SpamAssassin is configured with
defang_mime 0 and report_header 1, or when SA is simply used to add
headers for postprocessing later.  Updating the body through the milter
interface can be slow for large messages.
.It Fl r Ar nn
Reject scanned email if it greater than or equal to
.Ar nn .
If 
.Ar -1 ,
reject scanned email if SpamAssassin tags it as spam (useful if you
are also using the
.Fl u
flag, and users have changed their required_hits value).
.Pp
For example: if you usually use procmail to redirect tagged email into
a separate folder just in case of false positives, you can use
.Fl r Ar 15
and reject flagrant spam outright while still receiving low-scoring
messages.
.It Fl u Ar defaultuser
Pass the username part of the first recipient to spamc with the 
.Fl u 
flag.  This allows user preferences files to be used.  If the message is
addressed to multiple recipients, the username
.Ar defaultuser
is passed instead.
.Pp
Note that 
.Nm
does not know whether an email is incoming or outgoing, so a message
from user1@localdomain.com to user2@yahoo.com will make 
.Nm
pass 
.Fl u Ar user2
to spamc.
.It Fl - Ar spamc flags ...
Pass all remaining options to spamc.  
This allows you to connect to a remote spamd with
.Fl d
or 
.Fl p .
.El
.Sh FILES
.Bl -tag -width "indent"
.It Pa @SPAMC@
client interface to SpamAssassin
.El
.Sh SEE ALSO
.Xr spamassassin 1 ,
.Xr spamd 1
.Sh AUTHORS
.An "Georg C. F. Greve" Aq greve@gnu.org
.An "Dan Nelson" Aq dnelson@allantgroup.com
