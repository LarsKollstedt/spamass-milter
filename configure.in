dnl Process this file with autoconf to produce a configure script.
dnl $Id: configure.in,v 1.4 2002/03/06 13:07:07 greve Exp $
AC_INIT(configure.in)

PACKAGE="spamass-milter"
MAJOR_VERSION=0
MINOR_VERSION=1
MICRO_VERSION=2
VERSION=$MAJOR_VERSION.$MINOR_VERSION.$MICRO_VERSION

AC_DEFINE_UNQUOTED(PACKAGE, "$PACKAGE")
AC_DEFINE_UNQUOTED(VERSION, "$VERSION")
AC_SUBST(PACKAGE)
AC_SUBST(VERSION)

dnl Initialize automake now
AM_INIT_AUTOMAKE($PACKAGE, $VERSION)
AC_PREFIX_DEFAULT("/usr/local")

dnl checks for needed compilers
CFLAGS=""
if test x${CXXFLAGS+set} = xset ; then
  :
else
  CXXFLAGS="-O2"
fi
AC_PROG_CC
AC_PROG_CXX
AC_PROG_RANLIB

dnl search for spamc
AC_PATH_PROG(SPAMC, spamc)
if test "$SPAMC" = "" ; then
   AC_MSG_ERROR("Spamc not found. Is SpamAssassin installed?")
fi
AC_DEFINE_UNQUOTED(SPAMC, "$SPAMC")
AC_SUBST(SPAMC)

dnl now some other stuff
AM_CONFIG_HEADER(config.h)
AM_SANITY_CHECK
AC_PROG_AWK
AC_PROG_LN_S
AC_PROG_INSTALL
AC_HEADER_STDC
AC_CANONICAL_HOST

dnl check for GNU POSIX thread library
AC_CHECK_LIB(pthread, pthread_create)

dnl
dnl debugging ?!
dnl
AC_ARG_ENABLE(debug,
     [  --enable-debug          turn on debugging],
     [case "${enableval}" in
       yes) debug=true ;;
       no)  debug=false ;;
       *) AC_MSG_ERROR(bad value ${enableval} for --enable-debug) ;;
     esac],[debug=false])
AM_CONDITIONAL(DEBUG, test x$debug = xtrue)

dnl  Makefiles to create:
AC_OUTPUT(Makefile)

